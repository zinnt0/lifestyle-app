# Lifestyle App - Fitness & Nutrition Tracker

**Last Updated:** 2025-12-30
**Project Type:** React Native (Expo) Lifestyle Application
**Branch:** feature/training-section
**Status:** Active Development

---

## Projekt-Ãœbersicht

React Native (Expo) App fÃ¼r Training, ErnÃ¤hrung und Supplements.
Eine umfassende Lifestyle-Anwendung mit Training Management, Recovery Tracking, Nutrition Tracking und User Profile Management. Die App nutzt Supabase als Backend und folgt einer modularen, feature-basierten Architektur.

Zielgruppe: Fitness-Enthusiasten, wissenschaftlich fundiert.

---

## Tech Stack

- **Frontend**: React Native 0.81.5 + Expo ~54.0.30 (TypeScript 5.9.2)
- **Backend**: Supabase (PostgreSQL + Auth)
- **Navigation**: React Navigation 7.x (Native Stack + Bottom Tabs)
- **UI Library**: React Native Paper 5.14.5
- **State Management**: React Context API + AsyncStorage
- **Testing**: tsx 4.19.2 fÃ¼r TypeScript test execution

---

## Projekt-Struktur

```
lifestyle-app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # App entry points
â”‚   â”œâ”€â”€ lib/                    # Third-party library configs
â”‚   â”‚   â””â”€â”€ supabase.ts         # âœ… Supabase client mit AsyncStorage
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                 # âœ… 13 UI Components (Reusable)
â”‚   â”‚   â””â”€â”€ training/           # âœ… Training feature components (NEW)
â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”œâ”€â”€ Training/           # âœ… Training screens (NEW)
â”‚   â”‚   â”œâ”€â”€ onboarding/         # âœ… 6 Onboarding Screens + Summary
â”‚   â”‚   â”œâ”€â”€ app/                # âœ… Main app screens (Home, Profile, DailyCheckin)
â”‚   â”‚   â”œâ”€â”€ auth/               # â¸ï¸ Login, Register
â”‚   â”‚   â””â”€â”€ nutrition/          # â¸ï¸ Nutrition screens
â”‚   â”œâ”€â”€ services/               # Business logic & API services
â”‚   â”‚   â”œâ”€â”€ auth.service.ts     # âœ… Authentication service
â”‚   â”‚   â”œâ”€â”€ profile.service.ts  # âœ… Profile & onboarding service
â”‚   â”‚   â”œâ”€â”€ recovery.service.ts # âœ… Recovery tracking service
â”‚   â”‚   â”œâ”€â”€ trainingService.ts  # âœ… Training service with caching
â”‚   â”‚   â””â”€â”€ calorieCalculationService.ts  # âœ… Calorie calculations (NEW)
â”‚   â”œâ”€â”€ utils/                  # Utility functions & helpers
â”‚   â”‚   â”œâ”€â”€ validation.ts       # âœ… Form validation functions
â”‚   â”‚   â”œâ”€â”€ planRecommendationScoring.ts  # âœ… 4D Scoring Algorithm (NEW)
â”‚   â”‚   â””â”€â”€ recommendationAnalytics.ts    # âœ… Analytics System (NEW)
â”‚   â”œâ”€â”€ contexts/               # React Context providers
â”‚   â”‚   â””â”€â”€ OnboardingContext.tsx  # âœ… 6-step onboarding state
â”‚   â”œâ”€â”€ hooks/                  # Custom React hooks
â”‚   â”‚   â””â”€â”€ useForm.ts          # âœ… Form state management
â”‚   â”œâ”€â”€ types/                  # TypeScript type definitions
â”‚   â”‚   â””â”€â”€ training.types.ts   # âœ… Training types (NEW)
â”‚   â”œâ”€â”€ tests/                  # Test files
â”‚   â”‚   â”œâ”€â”€ auth.test.simple.ts # âœ… Auth tests
â”‚   â”‚   â””â”€â”€ validation.test.ts  # âœ… Validation tests (59 tests)
â”‚   â””â”€â”€ navigation/             # âœ… Complete navigation system
â”‚       â”œâ”€â”€ AppNavigator.tsx    # âœ… Root navigator (Auth/Onboarding/Main routing)
â”‚       â”œâ”€â”€ OnboardingNavigator.tsx  # âœ… Onboarding flow coordinator
â”‚       â”œâ”€â”€ MainNavigator.tsx   # âœ… Main app navigation
â”‚       â”œâ”€â”€ types.ts            # âœ… Navigation type definitions
â”‚       â””â”€â”€ index.ts            # âœ… Navigation exports
â”œâ”€â”€ .claude/                    # AI agent definitions & documentation
â”‚   â”œâ”€â”€ agents/                 # Specialized AI agents
â”‚   â”œâ”€â”€ deliverables/           # Feature implementation summaries
â”‚   â”œâ”€â”€ migrations/             # Architecture migration guides
â”‚   â”œâ”€â”€ research/               # Technical research & optimization docs
â”‚   â””â”€â”€ test-reports/           # Test execution reports
â”œâ”€â”€ docs/                       # Integration guides
â”œâ”€â”€ scripts/                    # Utility scripts
â”œâ”€â”€ sql/                        # Database migrations
â””â”€â”€ supabase/                   # Supabase configuration
```

---

## Recent Major Changes (December 2024 - January 2025)

### Training Section Enhancement (Feature Branch: feature/training-section)

**Date:** 2024-12-28 to 2025-12-30

Eine umfassende Ãœberarbeitung des Training-Moduls mit intelligenten Plan-Empfehlungen, Kalorienverfolgung, Fitness-Statistiken und erweiterten Scoring-Algorithmen.

#### 1. New Training Components

**Location:** `src/components/training/`

- **CalorieCard.tsx**
  - Zeigt Kalorienverbrauch fÃ¼r Workouts
  - Echtzeit-Kalorienberechnung Integration

- **ExerciseCalorieBreakdown.tsx**
  - Detaillierte KalorienaufschlÃ¼sselung pro Ãœbung
  - Visuelle Darstellung des Energieverbrauchs

- **FitnessStats.tsx**
  - Umfassendes Fitness-Statistik Dashboard
  - Tracking von Progress-Metriken und Performance-Indikatoren

- **PausedSessionCard.tsx**
  - Verwaltung und Anzeige pausierter Training Sessions
  - Quick Resume FunktionalitÃ¤t

- **PlanRecommendationCard.tsx**
  - Professionelle Empfehlungskarten mit Scoring-Breakdown
  - Interaktives UI mit erweiterbaren Score-Details
  - Badge-System fÃ¼r EmpfehlungsqualitÃ¤t
  - Integration Guide: `docs/INTEGRATION_GUIDE.md`

- **ScoreBreakdownChart.tsx** â­ PRODUCTION READY
  - **Status:** âœ… Production Ready (2024-12-29)
  - **Lines of Code:** 446 lines + 1779 lines total (mit Tests & Docs)
  - **Features:**
    - Animierte Bar Charts (0 â†’ Zielwert, 800ms mit 100ms Stagger)
    - 4 Score-Kategorien mit farbcodierter Visualisierung
    - Collapsible/Expandable Interface
    - Interaktive Info-Buttons mit Modal Dialogs
    - Accessibility-ready (WCAG 2.1 AA compliant)
    - 60fps smooth animations mit React.memo Optimierung
  - **Documentation:**
    - ScoreBreakdownChart.README.md - Komplette Usage Guide
    - ScoreBreakdownChart.SUMMARY.md - Implementation Summary
    - ScoreBreakdownChart.accessibility.md - WCAG Compliance Details
    - ScoreBreakdownChart.ANIMATION.md - Animation Specifications
  - **Testing:**
    - Comprehensive Test Suite: `__tests__/ScoreBreakdownChart.test.tsx`
    - Demo Component: `ScoreBreakdownChart.demo.tsx` (8 Szenarien)
    - Coverage: Rendering, Scores, Interactions, Accessibility, Edge Cases
  - **Accessibility:**
    - Color Contrast Ratios erfÃ¼llen alle WCAG 2.1 AA (4.5:1+)
    - Screen Reader Support (VoiceOver + TalkBack)
    - Touch Targets â‰¥44pt
    - Semantische Labels und Hints
  - **Known Issues:**
    - Kein Reduced Motion Support (medium priority)
    - Kein RTL Support (medium priority)
    - Keine Dark Mode Optimierung (medium priority)

**Component Index:** Alle Components exportiert via `src/components/training/index.ts`

#### 2. Updated Training Components

Die folgenden existierenden Components wurden signifikant erweitert:

- **ActivePlanCard.tsx** - Enhanced Plan Display mit neuen Metriken
- **AlternativesModal.tsx** - Verbesserte Exercise Alternative Selection
- **InactivePlanCard.tsx** - Aktualisierte Inactive Plan Visualisierung
- **QuickWorkoutAction.tsx** - Streamlined Quick Workout Initiation
- **SetRow.tsx** - Enhanced Set Tracking UI

#### 3. Training Screens Updates

**Location:** `src/screens/Training/`

Alle Training Screens wurden aktualisiert um neue Features zu integrieren:

- **TrainingDashboardScreen.tsx**
  - Zentrale Hub fÃ¼r Training Activities
  - Zeigt Active Plans, Paused Sessions, Fitness Stats

- **GuidedPlanFlowScreen.tsx**
  - Intelligenter Plan-Empfehlungsflow
  - Integration mit PlanRecommendationCard
  - User Profile-basiertes Plan Matching

- **CustomPlanFlowScreen.tsx**
  - Custom Plan Creation Workflow
  - Enhanced Validation und UX

- **TrainingPlanDetailScreen.tsx**
  - Detaillierte Plan-Ansicht mit allen Metriken
  - Calorie Tracking Integration

- **WorkoutSessionScreen.tsx**
  - Aktives Workout Tracking
  - Echtzeit-Kalorienberechnung
  - Pause/Resume FunktionalitÃ¤t

- **WorkoutSummaryScreen.tsx**
  - Post-Workout Summary mit detaillierten Analytics
  - Calorie Burn Summary und Exercise Breakdown

- **HomeScreen.tsx** (app level)
  - Aktualisiert fÃ¼r Training Module Changes
  - Quick Access zu Training Features

#### 4. Services & Business Logic

**Location:** `src/services/`

- **trainingService.ts** - Enhanced Training Logic
  - **Template Caching:** 5-Minuten In-Memory Cache fÃ¼r Plan Templates
  - **Optimierte Queries:** Explicit SELECT Lists, reduzierter Data Transfer
  - **Sorting:** Nach completion_status und popularity_score
  - **Neue Methods:**
    - `getPlanTemplates()` - Fetch all plan templates mit Caching
    - `clearTemplateCache()` - Cache Invalidation
    - `createPlanFromTemplate()` - Plan Creation von Recommendations
  - **Performance:** Drastisch reduzierter Database Access durch Caching

- **calorieCalculationService.ts** - Neuer Service
  - Echtzeit-Kalorienberechnung basierend auf Exercises
  - MET (Metabolic Equivalent of Task) Calculations
  - User Profile Integration (Weight, Age, Fitness Level)
  - Per-Exercise und Total Workout Calorie Tracking

**Testing:**
- Service Tests: `src/services/__tests__/`
- Test Scripts verfÃ¼gbar in package.json

#### 5. Utilities & Algorithms

**Location:** `src/utils/`

- **planRecommendationScoring.ts** â­ CORE ALGORITHM
  - **Intelligenter Plan Matching Algorithmus**
  - **4 Scoring Dimensions:**
    1. **Experience Score** (0-100): Matches User Fitness Level und Training Experience
    2. **Frequency Score** (0-100): Matches verfÃ¼gbare Training Days
    3. **Goal Score** (0-100): Matches Primary Fitness Goals
    4. **Volume Score** (0-100): Matches Training Volume Capacity
  - **Total Score:** Gewichteter Durchschnitt aller Dimensionen
  - **Completeness Tracking:** Identifiziert incomplete Plan Templates
  - **Optimizations:**
    - Nutzt `exercises_per_workout` direkt aus Database
    - Optimierte Volume Calculation: `calculateVolumeMatchOptimized()`
    - Fallback Support fÃ¼r Backwards Compatibility
  - **Functions:**
    - `getTopRecommendations()` - Returns Top N Recommendations
    - `calculateRecommendationScore()` - Main Scoring Engine
  - **Documentation:**
    - `.claude/research/scoring-optimization-summary.md`

- **recommendationAnalytics.ts** â­ ANALYTICS SYSTEM
  - **Comprehensive Analytics & Monitoring**
  - **Event Tracking:**
    - `recommendations_loaded` - Wenn Recommendations angezeigt werden
    - `plan_selected` - User wÃ¤hlt einen Plan
    - `plan_created` - Plan erfolgreich erstellt
    - `incomplete_warning_shown` - Warning angezeigt
    - `incomplete_plan_accepted` - User akzeptiert incomplete Plan
    - `recommendations_error` - System Errors
  - **Features:**
    - Session Management fÃ¼r Flow Analysis
    - Konfigurierbare Sampling Rate (0.0 - 1.0)
    - GDPR-Compliant mit User Consent Checks
    - Health Monitoring und Real-time Alerts
    - Fail-Safe: Crasht die App nie
  - **Health Checks:**
    - Low Recommendation Quality Alerts (Score < 60)
    - All Recommendations Incomplete Warnings
    - No Recommendations Available Alerts
    - Slow Loading Detection (> 2 Sekunden)
    - Large Score Gap Detection
  - **Database Integration:**
    - Events gespeichert in Supabase
    - SQL Dashboards fÃ¼r Insights
    - Migration: `supabase/migrations/20241229_create_recommendation_events.sql`
  - **Documentation:**
    - `.claude/research/analytics-implementation-report.md`

**Utility Testing:**
- Tests: `src/utils/__tests__/`
- Run: `npm run test:scoring` oder `npm run test:scoring:all`

**Exports:** Alle Utilities exportiert via `src/utils/index.ts`

#### 6. Type System Updates

**Location:** `src/types/training.types.ts`

Enhanced TypeScript Definitionen inklusive:
- Plan Recommendation Types
- Score Breakdown Types
- Calorie Tracking Types
- Workout Session Types
- Fitness Statistics Types

#### 7. Database Schema Changes

**Neue Felder zu plan_templates hinzugefÃ¼gt:**
- `estimated_sets_per_week` - Pre-calculated Total Sets per Week
- `exercises_per_workout` - Average Exercises per Workout Session
- `completion_status` - Plan Completeness Indicator ('complete' | 'incomplete')
- `popularity_score` - Plan Popularity Metric fÃ¼r Sorting

**Benefits:**
- Eliminiert Runtime Calculations wÃ¤hrend Scoring
- ErmÃ¶glicht Dynamic Completeness Management
- Verbessert Query Performance

#### 8. Testing Infrastructure (Training)

**Neue Test Files:**
- `src/components/training/__tests__/ScoreBreakdownChart.test.tsx`
- `src/services/__tests__/`
- `src/utils/__tests__/planRecommendationScoring.test.ts`

**Test Reports:**
- `.claude/test-reports/`
  - SUMMARY.md - Overall Test Summary
  - EXECUTIVE-SUMMARY.md - High-Level Overview
  - HOW-TO-RUN-TESTS.md - Test Execution Guide
  - README.md - Test Documentation
  - scoring-system-e2e-test-report.md - End-to-End Scoring Tests

**Test Scripts (package.json):**
```json
{
  "test": "tsx src/utils/__tests__/planRecommendationScoring.test.ts",
  "test:scoring": "tsx src/utils/__tests__/planRecommendationScoring.test.ts",
  "test:scoring:e2e": "tsx scripts/e2e-scoring-test-simple.ts",
  "test:scoring:all": "npm run test:scoring && npm run test:scoring:e2e",
  "test:auth": "tsx src/tests/auth.test.ts --quick",
  "test:auth:all": "tsx src/tests/auth.test.ts --all",
  "test:validation": "tsx src/tests/validation.test.ts"
}
```

#### 9. Documentation (Training)

**Neue Documentation Files:**

- **Integration Guides:**
  - `docs/INTEGRATION_GUIDE.md`
    - PlanRecommendationCard Integration Guide
    - Step-by-Step Implementation
    - Analytics Event Tracking
    - Error Handling Patterns

- **Research & Optimization:**
  - `.claude/research/analytics-implementation-report.md`
    - Analytics System Architecture
    - Event Tracking Specifications
    - Database Schema Details
    - Health Monitoring Configuration

  - `.claude/research/scoring-optimization-summary.md`
    - Scoring Algorithm Optimizations
    - Performance Improvements
    - Caching Strategies
    - Database Query Optimizations

  - `.claude/research/trainingsplan-entscheidungsbaum-optimierung.md`
    - Training Plan Decision Tree Optimization
    - Recommendation Logic Refinement

- **Deliverables:**
  - `.claude/deliverables/PlanRecommendationCard-Integration-Summary.md`
  - `.claude/deliverables/VISUAL_GUIDE.md`

- **Component Documentation:**
  - ScoreBreakdownChart.README.md - Component Usage Guide
  - ScoreBreakdownChart.SUMMARY.md - Implementation Details
  - ScoreBreakdownChart.accessibility.md - Accessibility Compliance
  - ScoreBreakdownChart.ANIMATION.md - Animation Specifications

- **Migration Guides:**
  - `.claude/migrations/README.md`
  - `.claude/migrations/QUICK_START.md`
  - `.claude/migrations/guided-flow-to-recommendations-migration.md`

- **Test Documentation:**
  - `.claude/tests/test-guided-plan-flow-recommendations.md`

---

## Supabase Schema

**18 Tabellen, alle erstellt:**

- Core: profiles, exercises (6 rows), intolerances_catalog (8 rows)
- Training: training_plans, plan_workouts, plan_exercises, workout_sessions, workout_sets, user_1rm, plan_templates
- Nutrition: nutrition_goals, meal_plans, meals, meal_items, food_items, daily_nutrition_log
- Supplements: supplements, user_supplements
- Analytics: recommendation_events (NEW)

**Wichtige Schema-Ã„nderungen:**
- `plan_templates` enhanced mit: `estimated_sets_per_week`, `exercises_per_workout`, `completion_status`, `popularity_score`
- `recommendation_events` fÃ¼r Analytics

**RLS aktiviert** auf allen User-Tabellen.

---

## Implementierte Features (Stand: 2025-12-30)

### 1. Authentication System (âœ… Komplett)

**Dateien**: `src/lib/supabase.ts`, `src/services/auth.service.ts`

**Funktionen**:
- `signUp(email, password)` - Registrierung mit deutscher Fehlerbehandlung
- `signIn(email, password)` - Login
- `signOut()` - Logout
- `getCurrentUser()` - Aktueller User
- `onAuthStateChange(callback)` - Auth state listener
- `resetPassword(email)` - Passwort zurÃ¼cksetzen
- `updatePassword(newPassword)` - Passwort Ã¤ndern

**Features**:
- AsyncStorage persistence fÃ¼r Sessions
- Alle Fehler in Deutsch
- TypeScript strict mode
- Response format: `{ user: User | null, error: string | null }`

**Tests**: `src/tests/auth.test.simple.ts` - Run mit `npm run test:auth:simple`

### 2. Form Validation System (âœ… Komplett)

**Dateien**: `src/utils/validation.ts`, `src/hooks/useForm.ts`

**Validators**:
- `validateEmail()` - Email-Format prÃ¼fen
- `validatePassword()` - Min 8 Zeichen, GroÃŸ-/Kleinbuchstaben, Zahl
- `validateName()` - Namen validieren
- `validateAge()` - Alter 13-120 Jahre
- `validateRegistrationForm()` - Komplette Registrierung
- `validateLoginForm()` - Login-Form

**useForm Hook**:
```typescript
const { values, errors, isSubmitting, handleChange, handleSubmit, reset } = useForm({
  initialValues: { email: '', password: '' },
  validate: validateLoginForm,
  onSubmit: async (values) => { /* logic */ }
});
```

**Tests**: 59 Unit Tests in `src/tests/validation.test.ts` - Run mit `npm run test:validation`

**Design-Entscheidung**: Keine externe Validation Library (Zod/Yup) fÃ¼r kleineren Bundle

### 3. UI Components (âœ… Komplett - 2025-12-26)

**Location**: `src/components/ui/`

**Basis Components** (ursprÃ¼nglich):
- `Button.tsx` - Variants: primary, secondary, outline
- `Card.tsx` - Container component
- `Input.tsx` - Text input mit error state
- `Text.tsx` - Typography mit size variants

**Neue Components** (2025-12-26):
- `ProgressBar.tsx` - Progress Indicator (0-100% mit animated fill)
- `RadioGroup.tsx` - Radio Button Group mit Vertical/Horizontal Layout
- `NumberPicker.tsx` - +/- Number Selector mit Min/Max bounds
- `MultiSelectChips.tsx` - Multi-Select Chips mit horizontal scrollbar
- `GoalCard.tsx` - Large Goal Selection Card mit Icon & Checkmark
- `Slider.tsx` - React Native Slider Wrapper mit Labels & Value Formatter
- `index.tsx` - Central export fÃ¼r alle UI Components

**Design System**:
- Consistent `COLORS` object (primary, secondary, text, border, error, success)
- `SPACING` constants (xs: 4, sm: 8, md: 16, lg: 24, xl: 32)
- `FONT_SIZES` (sm: 12, md: 14, lg: 16, xl: 18, xxl: 24)
- Style composition via `style` prop override

**Features**:
- TypeScript strict mode mit vollstÃ¤ndigen Interfaces
- Accessibility support (accessibilityLabel, accessibilityRole)
- Error states & validation feedback
- Loading states wo relevant
- Disabled states mit visueller RÃ¼ckmeldung
- Native Performance (keine Web-Dependencies)

### 4. Profile Service (âœ… Komplett) - **NEU 2025-12-26**

**Datei**: `src/services/profile.service.ts`

**Zweck**: Service Layer fÃ¼r Profile-Management und Onboarding-Daten

**Funktionen**:
- `createProfile(data)` - Erstellt/aktualisiert Profil mit Onboarding-Daten
- `getProfile(userId)` - LÃ¤dt User-Profil mit Intolerances
- `updateProfile(userId, updates)` - Aktualisiert spezifische Profil-Felder
- `getIntolerancesCatalog()` - LÃ¤dt Intolerances Katalog aus DB
- `saveUserIntolerances(userId, intoleranceIds)` - Speichert User Intolerances
- `getUserIntolerances(userId)` - Holt User Intolerances mit Details
- `isOnboardingCompleted(userId)` - PrÃ¼ft Onboarding-Status
- `getProfileCompleteness(userId)` - Berechnet Profil-VollstÃ¤ndigkeit (0-100%)

**Features**:
- Deutsche Fehlermeldungen mit automatischem Error-Mapping
- TypeScript strict typing
- Service Layer Pattern (Trennung von UI und Business Logic)
- Integration mit Supabase (profiles + user_intolerances tables)
- Wiederverwendbare Funktionen fÃ¼r verschiedene Screens

**Response Format**: `{ data: T | null, error: string | null }`

### 5. Onboarding Screens (âœ… Komplett - 2025-12-26)

**Location**: `src/screens/onboarding/`

**6 Onboarding Screens**:

1. **OnboardingScreen1.tsx** - Basisdaten
   - Age (NumberPicker: 13-120)
   - Weight (NumberPicker: 40-200 kg)
   - Height (NumberPicker: 140-220 cm)
   - Gender (RadioGroup: Male/Female/Diverse)

2. **OnboardingScreen2.tsx** - Trainingserfahrung
   - Training Level (RadioGroup: Beginner/Intermediate/Advanced/Elite)
   - Years of Experience (NumberPicker: 0-50)
   - Days per Week (NumberPicker: 1-7)
   - Equipment Access (RadioGroup: Gym/Home/Both/Bodyweight)

3. **OnboardingScreen3.tsx** - Fitnessziele
   - Goal Selection (5 GoalCards):
     - ğŸ’ª Kraft aufbauen
     - ğŸ‹ï¸ Muskelaufbau
     - ğŸ”¥ Gewicht verlieren
     - ğŸƒ Ausdauer steigern
     - ğŸŒŸ Allgemeine Fitness
   - Single-Select mit Icon & Checkmark

4. **OnboardingScreen4.tsx** - Lifestyle
   - Sleep Hours per Night (Slider: 4-12h mit 0.5h steps)
   - Stress Level (Slider: 1-10)

5. **OnboardingScreen5.tsx** - UnvertrÃ¤glichkeiten
   - LÃ¤dt Katalog aus Supabase (`intolerances_catalog`)
   - MultiSelectChips fÃ¼r Selection
   - Optional (Skip mÃ¶glich)
   - Error Handling mit Retry-Button

6. **OnboardingSummary.tsx** - Zusammenfassung & Submit
   - Zeigt alle Eingaben in Kategorien
   - "Bearbeiten" Links zu jedem Screen via `goToStep()`
   - Submit Button â†’ `submitOnboarding()` â†’ Supabase

**Gemeinsame Features**:
- âœ… Integration mit `OnboardingContext` via `useOnboarding()` hook
- âœ… Automatische Validierung vor `nextStep()`
- âœ… ProgressBar in jedem Screen (currentStep / totalSteps * 100)
- âœ… KeyboardAvoidingView fÃ¼r iOS/Android Keyboard-Handling
- âœ… ScrollView fÃ¼r alle Inhalte (responsive auf kleinen Screens)
- âœ… Deutsche Fehlermeldungen
- âœ… Loading States (Screen 5 beim Laden, Summary beim Submit)
- âœ… Error Handling mit User-Feedback
- âœ… Navigation: `nextStep()`, `previousStep()`, `goToStep(n)`

**Supabase Integration**:
- Screen 5: `getIntolerancesCatalog()` lÃ¤dt Optionen
- Summary: `submitOnboarding()` â†’ `createProfile()` â†’ Profil in DB

**Dokumentation**: `src/screens/onboarding/README.md`

### 6. Onboarding Context (âœ… Komplett - 2025-12-26)

**Datei**: `src/contexts/OnboardingContext.tsx`

**Zweck**: Zentrale State-Management fÃ¼r 6-stufigen Onboarding-Flow

**Architektur**:
- React Context + useReducer Pattern
- 6 separate Screens mit eigener Validation
- Integration mit ProfileService
- Progress Tracking (0-100%)

**State Structure**:
```typescript
{
  currentScreen: number,           // 0-5
  data: {
    gender: string | null,
    age: number | null,
    height: number | null,
    weight: number | null,
    goal: string | null,
    intolerances: string[]
  },
  errors: Record<string, string>,  // Field-level errors
  isSubmitting: boolean
}
```

**Actions**:
- `UPDATE_FIELD` - Update einzelnes Feld
- `NEXT_SCREEN` - NÃ¤chster Screen (mit Validation)
- `PREVIOUS_SCREEN` - ZurÃ¼ck
- `SET_ERROR` - Fehler setzen
- `CLEAR_ERROR` - Fehler lÃ¶schen
- `SET_SUBMITTING` - Loading state
- `RESET` - ZurÃ¼cksetzen

**Validation**:
- Screen-spezifische Validation vor Navigation
- Deutsche Fehlermeldungen
- Automatisches Error-Clearing bei Field-Update

### 7. Profile Edit System (âœ… Komplett - 2025-12-27)

**Location**: `src/screens/app/ProfileEditScreen.tsx`, `src/screens/app/ProfileScreen.tsx`

**Zweck**: ErmÃ¶glicht Usern, ihr Profil nach dem Onboarding zu bearbeiten

#### ProfileEditScreen

**Datei**: `src/screens/app/ProfileEditScreen.tsx`

**Architektur**:
- Comprehensive Single-Page Form mit 5 Sektionen
- ScrollView Layout mit KeyboardAvoidingView
- Integration mit ProfileService fÃ¼r CRUD Operations
- Reuse von Onboarding UI Components

**Form Sections**:

1. **Basisdaten** (Section 1)
   - Age (Input mit NumberPad, 13-120 Jahre)
   - Weight (Input mit DecimalPad, kg)
   - Height (Input mit DecimalPad, cm)
   - Gender (RadioGroup: Male/Female/Other)

2. **Training** (Section 2)
   - Fitness Level (OptionButtons: Beginner/Intermediate/Advanced)
   - Training Experience (Input, Monate)
   - Training Days per Week (NumberPicker: 1-7)
   - Gym Access (Switch: Ja/Nein)
   - Home Equipment (MultiSelectChips, conditional on no gym access)

3. **Trainingsziel** (Section 3)
   - Primary Goal (GoalCards mit Icons)

4. **Lifestyle** (Section 4)
   - Sleep Hours (Slider: 3-12h mit 0.5h steps)
   - Stress Level (Slider: 1-10)

5. **UnvertrÃ¤glichkeiten** (Section 5)
   - Checkboxes fÃ¼r Intolerances aus Katalog
   - Severity Picker (Mild/Moderate/Severe/Life-threatening) per Intolerance

**Input Handling Strategy**:
- **Numeric Fields**: Separate `inputStrings` state preserves comma/period during typing
- **Reason**: Prevents value disappearing when user types "75," for weight

**Validation**:
- Client-side validation via `validateForm()` before save
- Field-level validations
- German error messages
- Validation errors displayed in error banner

**Data Flow**:
1. **Load**: `loadProfile()` â†’ `getProfile(userId)` + `getUserIntolerances(userId)` â†’ Populate `formData`
2. **Edit**: User changes â†’ `updateField(field, value)` â†’ Updates `formData` state
3. **Save**: `handleSave()` â†’ `validateForm()` â†’ `updateProfile()` + `saveUserIntolerances()` â†’ Navigate back
4. **Cancel**: `handleCancel()` â†’ `navigation.goBack()` (no save)

**UI/UX Features**:
- âœ… Section Headers fÃ¼r klare Struktur
- âœ… Error/Success Banners (rot/grÃ¼n mit farbigem Hintergrund)
- âœ… Disabled states wÃ¤hrend Save
- âœ… Success Message mit Checkmark
- âœ… Auto-Navigation zurÃ¼ck zu ProfileScreen nach Success

#### ProfileScreen Updates

**Datei**: `src/screens/app/ProfileScreen.tsx`

**Neue Features**:

1. **Edit Button** (Header)
2. **Auto-Refresh via useFocusEffect**:
```typescript
useFocusEffect(
  useCallback(() => {
    loadProfile(); // Reload when screen comes into focus
  }, [])
);
```

**Navigation Flow**:
```
ProfileScreen â†’ ProfileEditScreen â†’ Edit â†’ Save â†’ Navigate back â†’ Auto-Refresh
```

### 8. Daily Recovery Tracking System (âœ… Komplett - 2025-12-28)

**Dateien**: `src/services/recovery.service.ts`, `src/screens/app/DailyCheckinScreen.tsx`

**Zweck**: TÃ¤gliches Tracking von Recovery-Metriken mit Score-Berechnung und Analytics

#### Recovery Service

**Datei**: `src/services/recovery.service.ts` (593 Zeilen)

**Core Metrics** (Required):
- Sleep Hours (0-12h)
- Sleep Quality (1-5)
- Stress Level (1-5, inverted fÃ¼r Score)
- Energy Level (1-5)
- Muscle Soreness (1-5, inverted fÃ¼r Score)
- Overall Readiness (1-5)

**Optional Metrics**:
- Mood (1-5)
- Hydration (1-5)
- Recovery Activities (string[])
- Notes (text)

**Recovery Score Algorithm**:
- Range: 0-100 (normalized)
- Weighted calculation:
  - Sleep Hours: 20% (optimal: 7-9h)
  - Sleep Quality: 20%
  - Energy Level: 15%
  - Stress Level: 15% (inverted)
  - Muscle Soreness: 15% (inverted)
  - Overall Readiness: 15%

**Score Interpretation**:
- 80-100: Excellent Recovery
- 60-79: Good Recovery
- 40-59: Moderate Recovery
- 20-39: Poor Recovery
- 0-19: Critical Recovery Needed

**Key Functions**:
```typescript
// CRUD
createRecoveryLog(data: RecoveryLogInput): Promise<RecoveryLog>
getRecoveryLog(date: string): Promise<RecoveryLog | null>
updateRecoveryLog(id: string, data: Partial<RecoveryLogInput>): Promise<RecoveryLog>
deleteRecoveryLog(id: string): Promise<void>
getAllRecoveryLogs(): Promise<RecoveryLog[]>

// Analytics
getRecoveryTrend(days: number): Promise<RecoveryTrend>
getCurrentStreak(): Promise<number>
getAverageScore(days: number): Promise<number>

// Helpers
calculateRecoveryScore(data: RecoveryLogInput): number
validateRecoveryInput(data: RecoveryLogInput): boolean
getScoreInterpretation(score: number): string
getRecommendation(score: number): string
```

**Data Storage**:
- AsyncStorage mit key structure: `recovery_log_${userId}_${date}`
- JSON serialization
- Date format: ISO (YYYY-MM-DD)

#### DailyCheckinScreen

**Datei**: `src/screens/app/DailyCheckinScreen.tsx` (750 Zeilen)

**Features**:
- Interactive Form mit Slider-Inputs fÃ¼r alle Metriken
- Real-time Recovery Score Preview mit color-coded display
- Pre-filled data fÃ¼r existing logs (Edit-Mode)
- Optional fields toggle
- Input validation mit visual feedback
- Success/Error messaging
- Haptic feedback (expo-haptics) on save
- Auto-navigation nach successful save

**UI Design**:
- Color-coded Recovery Score (Green/Blue/Yellow/Orange/Red)
- Slider-based inputs fÃ¼r intuitive entry
- Toggle fÃ¼r optional fields
- ScrollView layout mit KeyboardAvoidingView

**Integration**:
- HomeScreen displays current recovery status
- Auto-refresh on screen focus
- Navigation to DailyCheckinScreen

### 9. Training Module (âœ… Major Features Implementiert - 2024-12-28 to 2025-12-30)

**Status**: Production-Ready Components, Active Development fÃ¼r Screens

**Key Features**:
- âœ… Intelligent plan recommendations mit 4-dimensional scoring
- âœ… Calorie tracking and calculation
- âœ… Fitness statistics dashboard
- âœ… Workout session management mit pause/resume
- âœ… Exercise alternatives
- âœ… Custom and guided plan creation flows
- âœ… Comprehensive analytics and monitoring
- âœ… Real-time health checks and alerts

**Core Components**: Siehe "Recent Major Changes - Training Section Enhancement" oben

### 10. Navigation System (âœ… Komplett - 2025-12-26, updated 2025-12-28)

**Location**: `src/navigation/`

**Architektur**: Drei-Schicht Navigation (Auth â†’ Onboarding â†’ Main App)

#### AppNavigator (Root Navigator)

**Datei**: `src/navigation/AppNavigator.tsx`

**Zweck**: Root-Level Navigation die zwischen drei Hauptflows routet

**Features**:
- âœ… Authentication State Management via `onAuthStateChange()`
- âœ… Onboarding Completion Check via `isOnboardingCompleted()`
- âœ… Automatic Flow Routing basierend auf User Status
- âœ… Loading State wÃ¤hrend Auth/Onboarding Check
- âœ… Deep Link Configuration fÃ¼r Email Confirmation & Password Reset

**State Logic**:
```typescript
// Route to correct navigator
if (!user) return <AuthNavigator />;
if (!hasCompletedOnboarding) return <OnboardingNavigator />;
return <MainNavigator />;
```

**Deep Links**:
- `lifestyleapp://auth/callback` - Email Confirmation
- `lifestyleapp://auth/forgot-password` - Password Reset
- `lifestyleapp://login` - Login Screen
- `lifestyleapp://home` - Home Screen
- `lifestyleapp://profile` - Profile Screen

#### OnboardingNavigator

**Datei**: `src/navigation/OnboardingNavigator.tsx`

**Zweck**: Managed den 6-Screen Onboarding Flow

**Architektur**:
- State-based Navigation (nicht Stack-based)
- OnboardingContext managed `currentStep` (1-6)
- Switch-Statement rendert passenden Screen basierend auf Step

**Screen Mapping**:
- Step 1 â†’ OnboardingScreen1 (Basisdaten)
- Step 2 â†’ OnboardingScreen2 (Trainingserfahrung)
- Step 3 â†’ OnboardingScreen3 (Fitnessziele)
- Step 4 â†’ OnboardingScreen4 (Lifestyle)
- Step 5 â†’ OnboardingScreen5 (UnvertrÃ¤glichkeiten)
- Step 6 â†’ OnboardingSummary (Submit)

**Navigation Methods**:
- `nextStep()` - NÃ¤chster Screen (mit Validation)
- `previousStep()` - Vorheriger Screen
- `goToStep(n)` - Direkter Sprung zu Screen

#### MainNavigator

**Datei**: `src/navigation/MainNavigator.tsx`

**Zweck**: React Navigation Stack fÃ¼r Main App Screens

**Stack Screens**:
- Home (`src/screens/app/HomeScreen.tsx`) - Dashboard/Landing mit recovery status
- Profile (`src/screens/app/ProfileScreen.tsx`) - User Profile Display
- ProfileEdit (`src/screens/app/ProfileEditScreen.tsx`) - Profile Editing Form
- DailyCheckin (`src/screens/app/DailyCheckinScreen.tsx`) - Daily Recovery Check-in

**Configuration**:
```typescript
<Stack.Navigator
  screenOptions={{
    headerShown: true,
    animation: "slide_from_right",
  }}
  initialRouteName="Home"
>
```

**Features**:
- âœ… Native Stack Navigator (performanter als Stack)
- âœ… iOS Large Title Support
- âœ… Slide Animation
- âœ… Profile Edit Flow mit automatic data refresh
- âœ… Daily Recovery Check-in Flow

**Future Screens** (geplant):
- Training Dashboard
- Training Plan Detail
- Workout Session
- Nutrition
- Progress/Stats

#### Navigation Types

**Datei**: `src/navigation/types.ts`

**TypeScript Param Lists fÃ¼r Type-Safe Navigation**:

```typescript
// Auth Flow
export type AuthStackParamList = {
  Login: undefined;
  Register: undefined;
  ForgotPassword: undefined;
  Welcome: undefined;
  AuthCallback: undefined;
};

// Main App Flow
export type MainStackParamList = {
  Home: undefined;
  Profile: undefined;
  ProfileEdit: undefined;
  DailyCheckin: { date?: string; logId?: string };
  Settings: undefined;
};
```

#### Navigation Flow Diagram

```
App Start
    â†“
AppNavigator (Root)
    â”œâ”€ getCurrentUser()
    â”œâ”€ isOnboardingCompleted()
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Not Authenticatedâ”‚ Auth + No Onboardingâ”‚ Auth + Onboardingâ”‚
â”‚                  â”‚                     â”‚                  â”‚
â†“                  â†“                     â†“
AuthNavigator      OnboardingNavigator   MainNavigator
(Login, Register)  (6 Screens)          (Home, Profile, DailyCheckin)
    â†“                     â†“
Sign In/Up         submitOnboarding()
    â†“                     â†“
OnboardingNavigator  â†’ MainNavigator
```

---

## Architecture Patterns

### Component Organization
- **Feature-based structure:** Components organized by feature (training, recovery, nutrition)
- **Index exports:** Each feature directory has an index.ts for clean imports
- **Separation of concerns:** UI components, services, and utilities clearly separated

### State Management
- **React Context API:** For global app state
- **Local component state:** For UI-specific state
- **AsyncStorage:** For persistent data caching
- **Service layer caching:** 5-minute TTL for frequently accessed data

### Data Flow
1. **User Input** â†’ Screen Component
2. **Screen Component** â†’ Service Layer
3. **Service Layer** â†’ Supabase API / Local Cache
4. **Response** â†’ Service Layer (with caching)
5. **Service Layer** â†’ Screen Component
6. **Screen Component** â†’ UI Components

### Performance Optimizations
- **Template Caching:** 5-minute in-memory cache for plan templates
- **React.memo:** Used for expensive components (e.g., ScoreBreakdownChart)
- **Optimized Queries:** Explicit SELECT lists, only necessary fields
- **Lazy Loading:** Components and data loaded on demand
- **Animation Performance:** 60fps target, staggered animations

### Accessibility Standards
- **WCAG 2.1 AA Compliance:** Target for all new components
- **Color Contrast:** Minimum 4.5:1 for text, 3:1 for UI components
- **Touch Targets:** Minimum 44Ã—44pt for all interactive elements
- **Screen Reader Support:** Semantic labels, hints, and roles
- **Keyboard Navigation:** Full keyboard accessibility

---

## AI Agent System

The project uses specialized AI agents for different development tasks:

**Location:** `.claude/agents/`

### Active Agents

- **context-manager.md** - Maintains this documentation file
- **training-planner-agent.md** - Training feature development
- **training-service-builder.md** - Training service layer
- **training-screens-builder.md** - Training screen development
- **training-navigation-builder.md** - Training navigation
- **training-ui-components-builder.md** - Training UI components
- **unit-test-generator.md** - Test generation
- **recovery-schema-builder.md** - Recovery feature schema
- **recovery-service-builder.md** - Recovery service layer
- **profile-service-builder.md** - Profile management
- **profile-edit-screen-builder.md** - Profile editing
- **daily-checkin-screen-builder.md** - Daily check-in feature
- **onboarding-screens-builder.md** - Onboarding flow
- **onboarding-navigation-builder.md** - Onboarding navigation
- **onboarding-context-builder.md** - Onboarding state
- **auth-logic-builder.md** - Authentication logic
- **auth-screens-builder.md** - Authentication screens
- **form-validation-builder.md** - Form validation
- **ui-components-builder.md** - General UI components
- **supplement-agent.md** - Supplement tracking
- **github-repo-manager.md** - Repository management

---

## Aktuelle Phase: MVP + Training Module

**Abgeschlossen**:
- âœ… Authentication Service
- âœ… Form Validation System
- âœ… UI Components (13 Components)
- âœ… Testing Setup
- âœ… Profile Service
- âœ… Onboarding Context
- âœ… Onboarding Screens (6 Screens + Summary)
- âœ… **Navigation System**:
  - âœ… AppNavigator (Root with Auth/Onboarding/Main routing)
  - âœ… OnboardingNavigator (State-based 6-screen flow)
  - âœ… MainNavigator (Home/Profile/ProfileEdit/DailyCheckin stack)
  - âœ… Navigation Types (TypeScript param lists)
- âœ… Main App Screens (Home, Profile)
- âœ… **Profile Edit System**
- âœ… **Daily Recovery Tracking System**
- âœ… **Training Module** (Major Features):
  - âœ… Training Components (CalorieCard, ScoreBreakdownChart, etc.)
  - âœ… Training Services (trainingService, calorieCalculationService)
  - âœ… Training Utilities (4D Scoring Algorithm, Analytics)
  - âœ… Training Screens (Dashboard, Guided Flow, Custom Flow, etc.)
  - âœ… Testing Infrastructure
  - âœ… Comprehensive Documentation

**In Arbeit**:
- ğŸ”„ Login & Registrierung Screens
- ğŸ”„ AuthNavigator Implementation
- ğŸ”„ App.tsx Integration & Testing

**NÃ¤chste Schritte**:
- â¸ï¸ Auth Screens fertigstellen (Login, Register, ForgotPassword)
- â¸ï¸ Training Module Integration Testing
- â¸ï¸ Nutrition Tracking
- â¸ï¸ Production Deployment Vorbereitung

---

## Architektur-Entscheidungen

### 1. Validation ohne externe Library
**Entscheidung**: Custom validation in `src/utils/validation.ts` statt Zod/Yup
**Grund**: Kleinerer Bundle, volle Kontrolle, ausreichend fÃ¼r MVP
**Impact**: 59 Tests, alle Validation-Regeln selbst definiert

### 2. Testing Setup ohne Framework
**Entscheidung**: `tsx` + console assertions statt Jest/Vitest
**Grund**: Schneller Setup, weniger Dependencies fÃ¼r MVP
**Future**: Migration zu Jest empfohlen wenn Projekt wÃ¤chst

### 3. Supabase AsyncStorage Integration
**Entscheidung**: AsyncStorage fÃ¼r Session persistence
**Grund**: Native persistence, keine zusÃ¤tzlichen Cookies nÃ¶tig
**Implementation**: In `src/lib/supabase.ts` konfiguriert

### 4. Deutsche Error Messages
**Entscheidung**: Alle Fehler in Deutsch
**Grund**: Zielgruppe ist deutsch
**Future**: i18n-Support wenn internationale Expansion geplant

### 5. Service Layer Pattern
**Entscheidung**: Separate `services/` fÃ¼r Business Logic
**Grund**: Trennung von UI und Logik, bessere Testbarkeit
**Example**: `auth.service.ts` kann ohne UI getestet werden
**Update**: Erweitert um Training, Recovery, Profile Services

### 6. Context + Reducer fÃ¼r Multi-Step Forms
**Entscheidung**: React Context + useReducer fÃ¼r Onboarding-Flow
**Grund**:
- Zentraler State Ã¼ber 6 Screens
- Validation vor Screen-Wechsel
- Einfaches Progress-Tracking
- Kein Redux fÃ¼r MVP nÃ¶tig
**Implementation**: `OnboardingContext.tsx` mit 7 Actions

### 7. Component-Based UI ohne externe UI Library
**Entscheidung**: Eigene UI Components in `src/components/ui/` statt Library
**Grund**:
- Volle Design-Kontrolle
- Kleinerer Bundle Size
- Keine Breaking Changes durch Library Updates
- Native Performance (kein Web-Bridge)
**Implementation**: 13 Components mit consistentem Design System

### 8. Multi-Step Onboarding Pattern
**Entscheidung**: 6 separate Screens statt Single-Page Form
**Grund**:
- Bessere UX auf Mobile
- Klare Progress-Indication
- Screen-spezifische Validation mÃ¶glich
- Einfacher zu navigieren
**Implementation**: State-based Navigation via OnboardingContext

### 9. Three-Tier Navigation Architecture
**Entscheidung**: Drei separate Navigator-Schichten (Auth, Onboarding, Main)
**Grund**:
- Klare Trennung
- Zustandsbasierte Navigation
- Einfache Flow-Kontrolle
- Bessere Performance
- Type Safety
**Implementation**: AppNavigator mit conditional rendering

### 10. State-Based vs Stack-Based Navigation fÃ¼r Onboarding
**Entscheidung**: State-Based Navigation fÃ¼r Onboarding
**Grund**:
- Bessere UX (kein Back-Stack Confusion)
- `goToStep(n)` erlaubt direkten Sprung
- Screen-Wechsel nur via `nextStep()` mit Validation
**Trade-off**: Kein nativer Back-Button Support

### 11. Profile Edit with Input String Preservation
**Entscheidung**: Separate `inputStrings` state fÃ¼r numeric inputs
**Problem**: React Native TextInput lÃ¶scht Value bei trailing comma
**Grund**: Bessere UX beim Tippen von Dezimalzahlen
**Trade-off**: Mehr State-Management, aber deutlich bessere UX

### 12. useFocusEffect fÃ¼r Auto-Refresh
**Entscheidung**: useFocusEffect Hook statt manueller Refresh-Button
**Grund**:
- Automatisches Reload nach RÃ¼ckkehr von ProfileEdit
- Bessere UX
- Stellt sicher dass User immer aktuelle Daten sieht
**Trade-off**: Minimaler Performance-Impact (akzeptabel)

### 13. Recovery Score Algorithm
**Entscheidung**: Weighted Score mit 6 Core Metrics (0-100 normalized)
**Grund**:
- Balanced Representation
- Inverted Scoring fÃ¼r negative Faktoren
- Industry-Standard Ranges
- Real-time Calculation
**Trade-off**: Simpler als ML-based, aber ausreichend fÃ¼r MVP

### 14. AsyncStorage fÃ¼r Recovery Data
**Entscheidung**: AsyncStorage statt Supabase fÃ¼r Recovery Logs
**Grund**:
- Offline-First
- Keine Network-Latency
- Privacy (sensible Health-Daten bleiben lokal)
- MVP-Speed
**Future**: Migration zu Supabase fÃ¼r cloud sync
**Trade-off**: Keine Cloud-Backup, aber bessere UX fÃ¼r MVP

### 15. Template Caching fÃ¼r Training Plans
**Entscheidung**: 5-Minuten In-Memory Cache fÃ¼r Plan Templates
**Grund**:
- Drastisch reduzierte Database Calls
- Bessere Performance
- Templates Ã¤ndern sich selten
**Implementation**: `trainingService.ts` mit TTL-based cache
**Trade-off**: Potential stale data, aber akzeptabel bei 5-min TTL

### 16. 4-Dimensional Scoring Algorithm
**Entscheidung**: Experience + Frequency + Goal + Volume Scoring
**Grund**:
- Holistische Plan-Bewertung
- BerÃ¼cksichtigt User-Profil vollstÃ¤ndig
- Transparente Score-Breakdown fÃ¼r User
- Optimierbar durch Database Pre-Calculations
**Implementation**: `planRecommendationScoring.ts`
**Trade-off**: Komplexer als simple Matching, aber viel prÃ¤ziser

### 17. GDPR-Compliant Analytics
**Entscheidung**: Built-in Analytics mit User Consent Checks
**Grund**:
- GDPR-Compliance von Anfang an
- User Privacy First
- Fail-Safe (crasht nie die App)
- Konfigurierbare Sampling Rate
**Implementation**: `recommendationAnalytics.ts`

---

## Development Guidelines

### Code Style
- **TypeScript:** Strict mode enabled, all files must be fully typed
- **Naming Conventions:**
  - Components: PascalCase (e.g., `PlanRecommendationCard.tsx`)
  - Services: camelCase with .ts extension (e.g., `trainingService.ts`)
  - Utilities: camelCase (e.g., `planRecommendationScoring.ts`)
  - Types: PascalCase interfaces and types (e.g., `PlanRecommendation`)
- **File Organization:**
  - One component per file
  - Co-located tests in `__tests__/` directories
  - Documentation files alongside components when needed
- Functional components + Hooks (keine Classes)
- Async/await (keine Promises.then)
- Descriptive variable names (deutsch ok)
- Error handling Ã¼berall
- Comments nur wenn nÃ¶tig
- Alle Dateien mit absoluten Pfaden referenzieren in Dokumentation

### Testing Requirements
- **Unit Tests:** For utilities and services
- **Component Tests:** For complex UI components
- **E2E Tests:** For critical user flows
- **Coverage Goals:** Focus on business logic and critical paths
- **Test Location:** `__tests__/` directories alongside source files

### Documentation Requirements
- **Component README:** For complex components (see ScoreBreakdownChart)
- **API Documentation:** For services and utilities
- **Migration Guides:** For architectural changes
- **Integration Guides:** For feature implementations

---

## Known Issues & Technical Debt

### Training Module
1. **ScoreBreakdownChart:**
   - âš ï¸ No reduced motion support (medium priority)
   - âš ï¸ No RTL support for Arabic/Hebrew (medium priority)
   - âš ï¸ No dark mode color optimization (medium priority)
   - Multi-language support needed (currently German only)

2. **Performance:**
   - Monitor template cache hit rates
   - Consider implementing request debouncing for rapid profile changes

3. **Analytics:**
   - Need to implement sampling rate configuration for high traffic
   - Add A/B testing framework for recommendation algorithm

### General
- Auth Screens noch nicht implementiert
- Nutrition Module noch nicht begonnen
- Supplement Tracking in Planung

### Future Enhancements
- Reduced motion accessibility support
- RTL language support
- Dark mode optimization
- Multi-language internationalization (i18n)
- Offline mode support
- Social features (plan sharing, leaderboards)
- Cloud sync fÃ¼r Recovery Logs
- Advanced analytics dashboard

---

## Build & Run

### Development
```bash
npm start          # Start Expo development server
npm run android    # Run on Android
npm run ios        # Run on iOS
npm run web        # Run in web browser
```

### Testing
```bash
npm test                  # Run all tests
npm run test:scoring      # Run scoring algorithm tests
npm run test:scoring:e2e  # Run end-to-end scoring tests
npm run test:scoring:all  # Run all scoring tests
npm run test:auth         # Run auth tests (quick)
npm run test:auth:all     # Run all auth tests
npm run test:validation   # Run validation tests
npm run lint              # TypeScript type checking
```

---

## Dependencies

### Production Dependencies
- React 19.1.0
- React Native 0.81.5
- Expo ~54.0.30
- Supabase JS Client 2.89.0
- React Navigation 7.x
- React Native Paper 5.14.5
- AsyncStorage 2.2.0
- Expo Linear Gradient 15.0.8
- Expo Haptics 15.0.8

### Development Dependencies
- TypeScript 5.9.2
- tsx 4.19.2 (TypeScript execution)
- ts-node 10.9.2
- dotenv 16.4.7

---

## Git Workflow

### Branch Strategy
- `main` - Production-ready code
- `feature/*` - Feature development branches
- Current: `feature/training-section`

### Commit Messages
Follow conventional commits format:
- `feat:` - New features
- `fix:` - Bug fixes
- `refactor:` - Code refactoring
- `docs:` - Documentation changes
- `test:` - Test additions/changes
- `chore:` - Maintenance tasks

### Recent Commits
- d0ae4d74 - Trainings feature begonnen
- f7ecd5c7 - Merge branch 'feature/recovery' into main
- 4e12a665 - feat: implement daily recovery tracking system
- 6a2234b4 - feat: add profile edit system with comprehensive form and auto-refresh
- 205643cd - Merge branch 'features/onboarding' into main

---

## Additional Resources

### Testing Guides
- `TRAINING_MODULE_TESTING.md`
- `CUSTOM_PLAN_FLOW_TESTING.md`

### Component Documentation
All major components have dedicated documentation in their respective directories.

### AI Agent Documentation
Refer to `.claude/agents/` for specialized agent capabilities and usage.

---

## Supabase Access

Via MCP Server - direkte DB-Zugriffe mÃ¶glich.

---

**Note:** This document is actively maintained by the context-manager agent and should be updated whenever significant changes are made to the project architecture, features, or development practices.
